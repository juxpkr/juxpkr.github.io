---
layout: posts
title: 2025-07-06-재난문자 API 활용 데이터 파이프라인 미니 프로젝트
date: 2025-07-06 15:59:34 +0900
category: Projects
tags:
  - Projects
  - AzureFunctions
---

### **[Projects] 재난문자 API 활용 실시간 알림 시스템 구축**



#### 1. 프로젝트 개요
- **문제 정의** : 기존 재난문자 알림은 정부 시스템을 통해 일괄적으로 제공되지만, 개발자나 특정 팀이 새로운 재난문자를 실시간으로 감지하고 특정 채널(예: Teams 메신저)로 즉시 알림을 받으며, 이력 관리까지 할 수 있는 자동화된 시스템은 부재했다. 실시간 정보의 중요성이 커지는 현대 사회에서, 이러한 정보의 신속한 파악과 공유는 필수적이다.
- **프로젝트 목표** : 행정안전부 재난문자 공공API를 활용하여, 새로운 재난문자가 발생할 경우 이를 실시간으로 감지하고, 팀 채널(Teams, Slack 등)로 즉시 알림을 전송하는 자동화된 시스템을 구축하는 것을 목표로 했다. 또한, 불필요한 중복 알림을 방지하고, 시스템 상태를 추적할 수 있도록 구현했다.
- **주요 성과** : Azure Functions의 서버리스 특성과 Event Hub의 스트리밍 기능을 활용하여, 5분마다 API를 수집하고 새로운 메시지를 감지하여 Teams에 실시간 알림을 보내는 End-to-End 파이프라인을 성공적으로 구현했다.

#### 2. 아키텍처 및 기술 스택

이 프로젝트는 Azure 클라우드 서비스의 다양한 구성 요소를 활용하여 유연하고 확장 가능한 실시간 데이터 파이프라인을 구축했다.

##### 2.1 아키텍처 다이어그램


##### 2.2 사용 기술 스택
- **Azure Functions (Python 3.11)** : 재난문자 API 호출 및 데이터 처리, Event Hub로 데이터 전송, 웹훅 알림 전송 등 핵심 로직을 담당하는 서버리스 컴퓨팅 서비스. (자세한 내용은 [Azure Functions 블로그 포스팅 링크](/learn/Azure-Functions)참조) 
	- 트리거 : Time Trigger (5분 주기 실행)
	- 바인딩 : Event  Hub Output Binding, Blob Storage Input/Output Binding, HTTP Output Binding (Webhook)
- Azure Event Hubs : Functions App에서 전송된 새로운 재난문자 데이터를 안정적으로 수집하고 스트리밍하는 고처리량 이벤트 허브(Event hub 블로그 포스팅 링크)
- Azure Blob Storage : 이전에 처리된 재난문자 ID를 저장하여 중복 알림을 방지하는 상태 관리 저장소
- Teams Webhook (또는 Slack/Discord Webhook) : Functions에서 처리된 알림 메시지를 팀 채널로 실시간 전송하는 통신 채널
- Python : 프로젝트 로직 구현 언어
	- `requests` : 외부 API 호출을 위한 라이브러리
	- `azure-storage-blob` : Blob Storage 연동을 위한 라이브러리
- Azure Stream Analytics & Power BI : Event Hubs로 수집된 데이터를 실시간으로 분석하고 시각화 하기 위한 추가 계획

##### 3. 주요 기능 및 구현 

###### 3.1 주기적인 재난문자 API 호출
- Time Trigger 활용 : Azure Functions의 Time Trigger를 사용하여 5분마다 행정안전부 재난문자 API를 자동으로 호출한다. 이는 수동 작업 없이 항상 최신 정보를 확인하는 자동화된 시스템을 구축한다.
###### 3.2 새로운 메시지 감지 및 중복 방지
- Blob Storage 기반 상태 관리 : Blob Storage의 특정 txt 파일에 마지막으로 처리된 재난문자의 고유 ID (예: 'SN' 값)를 저장한다.
- **ID 비교 로직** : API를 통해 새로 가져온 재난문자 목록을 Blob Storage에 저장된 이전 ID와 비교하여, 아직 처리되지 않은 '새로운' 메시지만을 정확하게 식별한다.

###### 3.3 실시간 데이터 스트리밍 및 알림
- **Event Hubs로 데이터 전송** : 새로 감지된 재난문자 데이터는 Azure Functions의 Event Hub Output Binding을 통해 Event Hub로 즉시 전송된다. 이는 이후 실시간 분석 파이프라인의 기초를 마련한다.
- 조건부 웹훅 알림 : 
	- 새로운 메시지 발생 시 : 새로운 재난문자가 감지되면, 해당 내용을 상세히 포함한 알림 메시지를 Teams 웹훅으로 즉시 전송한다.
	- 변동 없을 시 : 새로운 메시지가 없더라도, 시스템이 정상적으로 작동하고 있음을 확인하는 간략한 알림을 주기적으로 전송하여 모니터링을 돕는다.
